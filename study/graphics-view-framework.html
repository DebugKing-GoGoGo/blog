<!DOCTYPE HTML>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width">
    <meta name="generator" content="nico 0.5.0">
    <meta name="theme" content="one 0.2">
    <title>Graphics View Framework(Qt5)学习笔记</title>
    <link rel="stylesheet" href="../static/one.css" />
  </head>
  <body>
    <div class="header">
      <div class="container">
        <div class="brand">
          <a class="home" href="../">pezy's blog</a>
        </div>
        <div class="menu" role="navigation">
          <a href="https://github.com/pezy/blog/wiki/..">Wiki</a>
          <a href="../../../../../life">Life</a>
          <a href="../../../../../work">Work</a>
          <a href="../../../../../study">Study</a>
          <a href="../../../../../essay">Essay</a>
          <a href="../../../../../poem">听雨集</a>
        </div>
      </div>
    </div>
    <div class="document yue">
<div class="hentry" itemscope itemtype="http://schema.org/Article">
  <h1 class="entry-title" itemprop="name">Graphics View Framework(Qt5)学习笔记</h1>
  <div class="entry-content" itemprop="articleBody"><p>本文基本内容翻译自<a href="http://qt-project.org/doc/qt-5/graphicsview.html">Qt官网的Graphics View Framework介绍</a>，一切权利归qt-project.org所有。</p>
<h2 id="场景-scene">场景(Scene)</h2><p><a href="http://qt-project.org/doc/qt-5/qgraphicsscene.html">QGraphicsScene</a>提供了图形视图场景。</p>
<p>场景的职责如下：</p>
<ul>
<li>提供一个快速的接口来管理大量的物件。</li>
<li>为每个物件传递事件</li>
<li>管理物件状态，如选择与光标的聚焦</li>
<li>提供无转换的渲染功能，主要为打印。</li>
</ul>
<p>场景相当于<a href="http://qt-project.org/doc/qt-5/qgraphicsitem.html">QGraphicsItem</a>对象的容器。</p>
<ul>
<li>增加物件：<a href="http://qt-project.org/doc/qt-5/qgraphicsscene.html#addItem">QGraphicsScene::addItem()</a></li>
<li>获取物件列表：<a href="http://qt-project.org/doc/qt-5/qgraphicsscene.html#items">QGraphicsScene::items()</a></li>
<li>获取特定点的最上层物件：<a href="http://qt-project.org/doc/qt-5/qgraphicsscene.html#itemAt">QGraphicsScene::itemAt()</a></li>
</ul>
<p>需要注意的是，这些函数的返回顺序都是<strong>从上至下</strong>的。</p>
<div class="highlight"><pre><code class="cpp">QGraphicsScene scene;
QGraphicsRectItem *rect = scene.addRect(QRectF(<span class="number">0</span>, <span class="number">0</span>, <span class="number">100</span>, <span class="number">100</span>));

QGraphicsItem *item = scene.itemAt(<span class="number">50</span>, <span class="number">50</span>);
<span class="comment">// item == rect</span></code></pre></div><ul>
<li>获取选择的区域：<a href="http://qt-project.org/doc/qt-5/qgraphicsscene.html#setSelectionArea">QGraphicsScene::setSelectionArea</a></li>
<li>获取选中物件列表：<a href="http://qt-project.org/doc/qt-5/qgraphicsscene.html#selectedItems">QGraphicsScene::selectedItems()</a></li>
<li>设置鼠标焦点：<a href="http://qt-project.org/doc/qt-5/qgraphicsscene.html#setFocusItem">QGraphicsScene::setFocusItem()</a></li>
<li>获取目前聚焦的物件：<a href="http://qt-project.org/doc/qt-5/qgraphicsscene.html#focusItem">QGraphicsScene::focusItem()</a></li>
<li>使用打印机驱动来渲染部分场景：<a href="http://qt-project.org/doc/qt-5/qgraphicsscene.html#render">QGraphicsScene::render()</a></li>
</ul>
<h2 id="视图-view">视图(View)</h2><p><a href="http://qt-project.org/doc/qt-5/qgraphicsview.html">QGraphicsView</a>提供了一个视图部件，它可视化了场景的内容。可以将多个视图呈现同一个场景，可以为同样的数据集合提供多个视图窗口。这个视图部件是一个带滚动轴的区域，它提供了一个滚动条来浏览大场景。要想支持OpenGL，可以调用<a href="http://qt-project.org/doc/qt-5/qabstractscrollarea.html#setViewport">QGraphicsView::setViewport()</a>设置QGLWidget为视觉窗口。</p>
<div class="highlight"><pre><code class="cpp">QGraphicsScene scene;
myPopulateScene(&amp;scene);

QGraphicsView view(&amp;scene);
view.show();</code></pre></div><p><strong>视图</strong>接收来自键盘和鼠标的输入事件，将其转变为<strong>场景</strong>事件(主要通过恰当的坐标转换)，然后将这些事件体现在可视化场景中。</p>
<ul>
<li>利用变换矩阵：<a href="http://qt-project.org/doc/qt-5/qgraphicsview.html#transform">QGraphicsView::transform()</a>(支持一些高级的浏览特点，如缩放与旋转)</li>
<li>场景与视图间的转换：<a href="http://qt-project.org/doc/qt-5/qgraphicsview.html#mapToScene">QGraphicsView::mapToScene()</a>、<a href="http://qt-project.org/doc/qt-5/qgraphicsview.html#mapFromScene">QGraphicsView::mapFromScene()</a></li>
</ul>
<p><img src="https://db.tt/2ozKNagR" alt="view widget"></p>
<h2 id="物件-item">物件(Item)</h2><p><a href="http://qt-project.org/doc/qt-5/qgraphicsitem.html">QGraphicsItem</a>是场景基本图形部件的基类。提供以下标准物件：</p>
<ul>
<li>矩形(<a href="http://qt-project.org/doc/qt-5/qgraphicsrectitem.html">QGraphicsRectItem</a>)</li>
<li>椭圆(<a href="http://qt-project.org/doc/qt-5/qgraphicsellipseitem.html">QGraphicsEllipseItem</a>)</li>
<li>文本框(<a href="http://qt-project.org/doc/qt-5/qgraphicstextitem.html">QGraphicsTextItem</a>)</li>
</ul>
<p>更多时候，我们都会自定义图形物件，那样会更加灵活的使用QGraphicsItem的特性。</p>
<p>除此之外，它还支持以下特点：</p>
<ul>
<li>鼠标的单击、移动、释放、双击、悬停、滚轮与右键菜单事件。</li>
<li>光标焦点、快捷键</li>
<li>拖拽</li>
<li>通过父子层级关系分组，见<a href="http://qt-project.org/doc/qt-5/qgraphicsitemgroup.html">QGraphicsItemGroup</a></li>
<li>碰撞检测</li>
</ul>
<p>与QGraphicView类似，物件存在一个局部坐标系统。提供了许多物件与物件、物件与场景间坐标对应功能。它也提供了矩阵变换函数：<a href="http://qt-project.org/doc/qt-5/qgraphicsitem.html#transform">QGraphicsItem::transform()</a>，这对缩放、旋转部分物件非常有效。</p>
<p>物件可以包含其他物件(子物件)。子物件继承父物件的转换关系。尽管变换可以累加，但这些功能仍然基于局部坐标系。</p>
<p>要支持碰撞检测，可以使用<a href="http://qt-project.org/doc/qt-5/qgraphicsitem.html#transform">QGraphicsItem::shape()</a>，<a href="https://qt-project.org/doc/qt-5/qgraphicsitem.html#collidesWithItem">QGraphicsItem::collidesWithItem()</a>
，<a href="https://qt-project.org/doc/qt-5/qgraphicsitem.html#collidesWithPath">QGraphicsItem::collidesWithPath</a>等函数。</p>
<p><img src="https://db.tt/viKSj9fy" alt="https://db.tt/viKSj9fy"></p>
<p>====<em>下次介绍图形视图中的坐标系统</em>====</p>
</div>

  <div class="entry-meta">
    <time class="updated" datetime="2014-04-20T15:37:00.000Z" itemprop="dateModified">Sunday, Apr 20th, 2014</time>
  </div><div class="ds-thread"></div>
<script type="text/javascript">
  var duoshuoQuery = {short_name:"pezy"};
  (function() {
    var ds = document.createElement('script');
    ds.type = 'text/javascript';ds.async = true;
    ds.src = 'http://static.duoshuo.com/embed.js';
    ds.charset = 'UTF-8';
    (document.getElementsByTagName('head')[0]
     || document.getElementsByTagName('body')[0]).appendChild(ds);
  })();
</script>
</div>
</div>
    <div class="footer">
      <p class="copyright">powered by <a href="">nico</a> 0.5.0</p>
    </div>
    <div class="github"><a class="github-link" href="https://github.com/pezy">Fork me on GitHub</a></div>
    <script src="../static/one.js"></script>
  </body>
</html>